document.addEventListener('DOMContentLoaded', () => {
    // --- Mobile Menu Toggle ---
    const menuToggle = document.querySelector('.menu-toggle');
    const navLinks = document.querySelector('.nav-links');
    const navItems = document.querySelectorAll('.nav-links li a');

    if (menuToggle && navLinks) {
        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            menuToggle.classList.toggle('active');
        });
    }

    navItems.forEach(item => {
        item.addEventListener('click', () => {
            if (navLinks.classList.contains('active')) {
                navLinks.classList.remove('active');
                menuToggle.classList.remove('active');
            }
        });
    });

    // --- Smooth Scrolling ---
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetElement = document.querySelector(this.getAttribute('href'));
            if (targetElement) {
                targetElement.scrollIntoView({ behavior: 'smooth' });
            }
        });
    });

    // Chatbot functionality
    const chatbotToggle = document.getElementById('chatbot-toggle');
    const chatbotBox = document.getElementById('chatbot-box');
    const closeChatbotBtn = document.getElementById('close-chatbot');

    if (chatbotToggle && chatbotBox && closeChatbotBtn) {
        console.log('Chatbot elements found');
        
        chatbotToggle.addEventListener('click', () => {
            console.log('Toggle button clicked');
            chatbotBox.classList.toggle('active');
        });

        closeChatbotBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            chatbotBox.classList.remove('active');
        });

        document.addEventListener('click', (e) => {
            if (!chatbotBox.contains(e.target) && !chatbotToggle.contains(e.target)) {
                chatbotBox.classList.remove('active');
            }
        });

        chatbotBox.addEventListener('click', (e) => {
            e.stopPropagation();
        });
    } else {
        console.error('Chatbot toggle elements not found!');
    }

    // --- Appointment Form ---
    const appointmentForm = document.querySelector('.appointment-form');
    if (appointmentForm) {
        appointmentForm.addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Form Submitted!');
            const formData = new FormData(this);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            console.log(data);

            alert('ุชู ุงุณุชูุงู ุทูุจ ุญุฌุฒู ุจูุฌุงุญ! ุณูุชูุงุตู ูุนู ูุฑูุจุงู.');
            this.reset();
        });
    }

    // Chatbot messaging system
    const chatBody = document.getElementById('chatbot-body');
    const chatInput = document.getElementById('chatbot-input');
    const sendBtn = document.getElementById('chatbot-send-btn');

    // ุงุณุชุจุฏู ุฏุงูุฉ getAIResponse ุจุงูููุฏ ุงูุฌุฏูุฏ:
    async function getAIResponse(userMessage) {
        try {
            // ุงุณุชุฎุฏู ุงููุณุงุฑ ุงููุทูู ููู API
            const response = await fetch('/api/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: userMessage
                })
            });

            if (response.ok) {
                const data = await response.json();
                return data.response;
            } else {
                throw new Error(`Server Error: ${response.status}`);
            }
            
        } catch (error) {
            console.error('API Error:', error);
            return getEnhancedResponse(userMessage);
        }
    }


    // ุฏุงูุฉ ุงูุฑุฏูุฏ ุงููุญููุฉ (ูุณุฎุฉ ุงุญุชูุงุทูุฉ)
    function getSmartResponse(message) {
        const lowerMessage = message.toLowerCase();
        
        const responses = {
            'ูุฑุญุจุง': 'ูุฑุญุจุงู ุจู! ๐ ุฃูุง ุงููุณุงุนุฏ ุงูุงูุชุฑุงุถู ููุฌูุน ุงูุนูุงุฏุงุช. ููู ูููููู ูุณุงุนุฏุชู ุงููููุ',
            'ุงููุง': 'ุฃููุงู ูุณููุงู! ๐ ุฃูุง ููุง ููุณุงุนุฏุชู ูู ุงุณุชูุณุงุฑุงุชู ุงูุทุจูุฉ ูุญุฌุฒ ุงูููุงุนูุฏ.',
            'ุงูุณูุงู ุนูููู': 'ูุนูููู ุงูุณูุงู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู! ๐ ููู ูููููู ุฎุฏูุชู ุงููููุ',
            'ุงููุง ูุณููุง': 'ุฃููุงู ูุณููุงู ุจู! ๐ธ ูุญู ุณุนุฏุงุก ุจุฎุฏูุชู. ูุง ุงูุฐู ุชุจุญุซ ุนููุ',
            
            'ุนูุงุฏุงุช': `๐ฅ **ุนูุงุฏุงุชูุง ุงููุชููุฑุฉ:**
โข ๐ฆท ุนูุงุฏุฉ ุงูุฃุณูุงู
โข ๐ถ ุนูุงุฏุฉ ุงูุฃุทูุงู  
โข ๐ฉบ ุนูุงุฏุฉ ุงูุฌูุฏูุฉ
โข โค๏ธ ุนูุงุฏุฉ ุงูุจุงุทูุฉ
โข ๐๏ธ ุนูุงุฏุฉ ุงูุนููู

ุฃู ุนูุงุฏุฉ ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏ ุนููุงุ`,

            'ุงุณูุงู': `๐ฆท **ุนูุงุฏุฉ ุงูุฃุณูุงู:**
โข ุชูุธูู ููุญุต ุฏูุฑู
โข ุญุดูุงุช ุชุฌููููุฉ
โข ุชุจููุถ ุงูุฃุณูุงู
โข ุชูููู ุงูุฃุณูุงู
โข ุนูุงุฌ ุงูุฌุฐูุฑ
โข ุฒุฑุงุนุฉ ุงูุฃุณูุงู

๐ **ุงูููุงุนูุฏ:** ูู ุงูุณุจุช ุฅูู ุงูุฎููุณ - 9 ุตุจุงุญุงู ุฅูู 9 ูุณุงุกู`,

            'ุงุทูุงู': `๐ถ **ุนูุงุฏุฉ ุงูุฃุทูุงู:**
โข ูุญูุตุงุช ุงูููู ูุงูุชุทูุฑ
โข ุงูุชุทุนููุงุช ุงูุฃุณุงุณูุฉ
โข ุนูุงุฌ ุงูุฃูุฑุงุถ ุงูุดุงุฆุนุฉ
โข ุงุณุชุดุงุฑุงุช ุงูุฑุถุงุนุฉ ูุงูุชุบุฐูุฉ
โข ูุชุงุจุนุฉ ุญุฏูุซู ุงูููุงุฏุฉ

๐ฉโโ๏ธ **ุงูุฏูุชูุฑุฉ ุณุงุฑุฉ ุนูู** - ูุชุฎุตุตุฉ ูู ุทุจ ุงูุฃุทูุงู`,

            'ุฌูุฏูุฉ': `๐ฉบ **ุนูุงุฏุฉ ุงูุฌูุฏูุฉ:**
โข ุนูุงุฌ ุญุจ ุงูุดุจุงุจ
โข ุงูุฃูุฑุงุถ ุงูุฌูุฏูุฉ ุงููุฒููุฉ
โข ุงูุนูุงูุฉ ุจุงูุจุดุฑุฉ
โข ุฅุฒุงูุฉ ุงูุดุงูุงุช ูุงูุฒูุงุฆุฏ
โข ุนูุงุฌ ุชุณุงูุท ุงูุดุนุฑ

๐จโโ๏ธ **ุงูุฏูุชูุฑ ุฃุญูุฏ ูุญูุฏ** - ุงุณุชุดุงุฑู ุงูุฃูุฑุงุถ ุงูุฌูุฏูุฉ
๐ **ุงูููุงุนูุฏ:** ุงูุฃุญุฏ ุฅูู ุงูุฎููุณ - 11 ุตุจุงุญุงู ุฅูู 7 ูุณุงุกู`,

            'ุฎุฏูุงุช': `๐ **ุฎุฏูุงุชูุง ุงูุทุจูุฉ:**
โข ๐ฌ ูุญูุตุงุช ุทุจูุฉ ุฏูุฑูุฉ ุดุงููุฉ
โข ๐ฉบ ุงุณุชุดุงุฑุงุช ุทุจูุฉ ูุชุฎุตุตุฉ
โข โ๏ธ ุฅุฌุฑุงุกุงุช ุฌุฑุงุญูุฉ ุจุณูุทุฉ
โข ๐งช ุชุญุงููู ูุฎุจุฑูุฉ ูุชูุงููุฉ
โข ๐ท ุฃุดุนุฉ ุชุดุฎูุตูุฉ ูุชูุฏูุฉ
โข ๐ ุชุทุนููุงุช ูููุงูุฉ

ุฃู ุฎุฏูุฉ ุชุฑูุฏ ุงูุงุณุชูุณุงุฑ ุนููุงุ`,

            'ุญุฌุฒ': `๐ **ุทุฑู ุญุฌุฒ ุงูููุนุฏ:**
1. ๐ **ูุงุชููุงู:** 966123456789
2. ๐ **ุฃูููุงูู:** ุงููุฃ ูููุฐุฌ ุงูุญุฌุฒ
3. ๐ฅ **ุญุถูุฑูุงู:** ุชูุถู ุจุฒูุงุฑุชูุง

ุฃู ุนูุงุฏุฉ ุชุฑูุฏ ุงูุญุฌุฒ ูููุงุ`,

            'ููุนุฏ': `๐ **ููุงุนูุฏ ุงูุนูู:**
โข ุงูุฃุญุฏ - ุงูุฎููุณ: 8:00 ุตุจุงุญุงู - 10:00 ูุณุงุกู
โข ุงูุฌูุนุฉ: 4:00 ูุณุงุกู - 10:00 ูุณุงุกู
โข ุงูุณุจุช: 9:00 ุตุจุงุญุงู - 6:00 ูุณุงุกู

ูุญุฌุฒ ููุนุฏุ ุงุฎุชุฑ ุงูุนูุงุฏุฉ ุงููุทููุจุฉ`,

            'ุฑูู': `๐ **ุงุชุตู ุจูุง:**
โข ุงููุงุชู: 966123456789
โข ุงููุงุชุณุงุจ: 966123456789
โข ููุทูุงุฑุฆ: 966123456789`,

            'ุนููุงู': `๐ **ุนููุงู ุงููุฌูุน:**
[ุนููุงู ูุฌูุน ุงูุนูุงุฏุงุช]
ุงูุฑูุงุถ - ุญู ุงูุนููุง - ุดุงุฑุน ุงูููู ููุฏ

๐บ๏ธ ููููู ุงุณุชุฎุฏุงู ุฎุฑุงุฆุท ุฌูุฌู ูููุตูู ุฅูููุง`,

            'ุงูู ุงูุนููุงู': `๐ฅ **ูููุนูุง:**
[ุนููุงู ูุฌูุน ุงูุนูุงุฏุงุช]
ุณูููุฉ ุงููุตูู ูููุงูู ูุฌุงููุฉ ููุณูุงุฑุงุช

๐ฑ ููุงุชุตุงู: 966123456789`,

            'ุณุนุฑ': `๐ต **ุงูุฃุณุนุงุฑ:**
โข ุชุฎุชูู ุญุณุจ ุงูุฎุฏูุฉ ูุงูุนูุงุฏุฉ
โข ูุฏููุง ุจุงูุงุช ูุนุฑูุถ ุฎุงุตุฉ
โข ููุฏู ุฎุตููุงุช ูููุดู ุงูุฏูุฑู

๐ ููุงุณุชูุณุงุฑ: 966123456789`,

            'ุงุณุนุงุฑ': `๐ต **ุงูุฃุณุนุงุฑ:**
โข ุชุฎุชูู ุญุณุจ ุงูุฎุฏูุฉ ูุงูุนูุงุฏุฉ
โข ูุฏููุง ุจุงูุงุช ูุนุฑูุถ ุฎุงุตุฉ
โข ููุฏู ุฎุตููุงุช ูููุดู ุงูุฏูุฑู

๐ ููุงุณุชูุณุงุฑ ุนู ุงูุฃุณุนุงุฑ: 966123456789
๐ฏ ุฃู ููููู ุฒูุงุฑุฉ ุงูุนูุงุฏุฉ ููุนุฑูุฉ ุงูุชูุงุตูู`,

            'ุทูุงุฑุฆ': `๐จ **ููุญุงูุงุช ุงูุทุงุฑุฆุฉ:**
โข ูุงุชู ุงูุทูุงุฑุฆ: 966123456789
โข ุฏุงุฎู ุฃููุงุช ุงูุนูู: ุชูุถู ุจุงูุญุถูุฑ ููุฑุงู`,

            'ุดูุฑุง': `ุงูุนูู! ๐ ุฏุงุฆูุงู ุณุนูุฏ ุจูุณุงุนุฏุชู.
ูู ููุงู ุดูุก ุขุฎุฑ ุชุฑูุฏ ูุนุฑูุชูุ`,

            'ููุชุงุฒ': `ุดูุฑุงู ูู! ๐ ูุฐุง ูุดุฌุนูุง ุนูู ุชูุฏูู ุงูุฃูุถู.
ููู ูููููู ูุณุงุนุฏุชู ุฃูุซุฑุ`,

            'default': `๐ค ูู ุฃููู ุณุคุงูู ุชูุงูุงู...

ูููููู ูุณุงุนุฏุชู ูู:
๐ฅ **ูุนูููุงุช ุงูุนูุงุฏุงุช**
๐ **ุญุฌุฒ ุงูููุงุนูุฏ**  
๐ **ุงูุงุชุตุงู ุจูุง**
๐ **ุงูุฎุฏูุงุช ุงูุทุจูุฉ**

ูุง ุงูุฐู ุชุฑูุฏ ูุนุฑูุชูุ`
        };

        // ุงูุจุญุซ ุนู ุฃูุถู ุฑุฏ
        for (const [keyword, response] of Object.entries(responses)) {
            if (lowerMessage.includes(keyword)) {
                return response;
            }
        }

        return responses['default'];
    }

    // ุงูุฎุทูุฉ 2: ุฃุถู ุฏุงูุฉ ุงูุฑุฏูุฏ ุงููุญููุฉ ุงููุญุณูุฉ:
    function getEnhancedResponse(message) {
        const lowerMessage = message.toLowerCase();
        
        // ูุธุงู ุฑุฏูุฏ ุฃุฐูู ูุฃูุซุฑ ูุฑููุฉ
        const responses = {
            // ุงูุชุญูุฉ
            'ูุฑุญุจุง': 'ูุฑุญุจุงู ุจู! ๐ ุฃูุง ุงููุณุงุนุฏ ุงูุงูุชุฑุงุถู ููุฌูุน ุงูุนูุงุฏุงุช. ุฃุณุฃููู ุนู ุฃู ุดูุก: ุนูุงุฏุงุชูุงุ ุฎุฏูุงุชูุงุ ุญุฌุฒ ุงูููุงุนูุฏุ ุฃู ุงุณุชูุณุงุฑุงุช ุทุจูุฉ ุนุงูุฉ.',
            'ุงููุง': 'ุฃููุงู ูุณููุงู! ๐ ุฃูุง ููุง ููุณุงุนุฏุชู ูู ุฃู ุงุณุชูุณุงุฑ ุทุจู ุฃู ุฎุฏูู. ููู ูููููู ุฎุฏูุชู ุงููููุ',
            'ุงูุณูุงู ุนูููู': 'ูุนูููู ุงูุณูุงู ูุฑุญูุฉ ุงููู ูุจุฑูุงุชู! ๐ ููู ูููููู ูุณุงุนุฏุชู ุงููููุ',
            
            // ุฃุณุฆูุฉ ุนุงูุฉ
            'ูู ุงูุช': 'ุฃูุง ุงููุณุงุนุฏ ุงูุงูุชุฑุงุถู ููุฌูุน ุงูุนูุงุฏุงุช! ๐ค ูููุชู ูุณุงุนุฏุชู ูู ุงูุงุณุชูุณุงุฑุงุช ุงูุทุจูุฉุ ูุนูููุงุช ุงูุนูุงุฏุงุชุ ุญุฌุฒ ุงูููุงุนูุฏุ ูุฃู ุฃุณุฆูุฉ ุฃุฎุฑู.',
            'ูุง ุงุณูู': 'ุฃูุง ุงููุณุงุนุฏ ุงูุงูุชุฑุงุถู ููุนูุงุฏุฉ! ููููู ููุงุฏุงุชู ุจุฃู ุงุณู ุชูุถูู. ููู ูููููู ูุณุงุนุฏุชูุ',
            'ุดูุฑุง': 'ุงูุนูู! ๐ ุฏุงุฆูุงู ุณุนูุฏ ุจูุณุงุนุฏุชู. ูู ูุฏูู ุฃู ุฃุณุฆูุฉ ุฃุฎุฑูุ',
            
            // ุงูุนูุงุฏุงุช
            'ุนูุงุฏุงุช': `๐ฅ **ุนูุงุฏุงุชูุง ุงููุชุฎุตุตุฉ:**
โข ๐ฆท ุนูุงุฏุฉ ุงูุฃุณูุงู - ุฌููุน ุนูุงุฌุงุช ุงูุฃุณูุงู ูุงูุชุฌููู
โข ๐ถ ุนูุงุฏุฉ ุงูุฃุทูุงู - ุฑุนุงูุฉ ูุงููุฉ ูู ุงูููุงุฏุฉ ูููุฑุงููุฉ  
โข ๐ฉบ ุนูุงุฏุฉ ุงูุฌูุฏูุฉ - ุนูุงุฌ ุงูุจุดุฑุฉ ูุงูุดุนุฑ ูุงูุฃุธุงูุฑ
โข โค๏ธ ุนูุงุฏุฉ ุงูุจุงุทูุฉ - ุฃูุฑุงุถ ุงูููุจ ูุงูุฏุงุฎููุฉ
โข ๐๏ธ ุนูุงุฏุฉ ุงูุนููู - ูุญูุตุงุช ูุนูุงุฌุงุช ูุชูุฏูุฉ
โข ๐ง ุนูุงุฏุฉ ุงูุฃุนุตุงุจ - ุฃูุฑุงุถ ุงูุฌูุงุฒ ุงูุนุตุจู

ุฃุฎุชุฑ ุนูุงุฏุฉ ููุนุฑูุฉ ุงููุฒูุฏ ุนููุง!`,

            // ุงูุฎุฏูุงุช
            'ุฎุฏูุงุช': `๐ **ุฎุฏูุงุชูุง ุงูุดุงููุฉ:**
โข ๐ฌ ูุญูุตุงุช ุทุจูุฉ ุฏูุฑูุฉ ุดุงููุฉ
โข ๐ฉบ ุงุณุชุดุงุฑุงุช ุทุจูุฉ ูุชุฎุตุตุฉ
โข โ๏ธ ุฅุฌุฑุงุกุงุช ุฌุฑุงุญูุฉ ุจุณูุทุฉ
โข ๐งช ุชุญุงููู ูุฎุจุฑูุฉ ูุชูุงููุฉ
โข ๐ท ุฃุดุนุฉ ุชุดุฎูุตูุฉ ูุชูุฏูุฉ
โข ๐ ุชุทุนููุงุช ูููุงูุฉ
โข ๐ฅ ุฑุนุงูุฉ ูุง ุจุนุฏ ุงูุนูููุงุช

ุฃู ุฎุฏูุฉ ุชุฑูุฏ ุงูุงุณุชูุณุงุฑ ุนููุงุ`,

            // ุงูุญุฌุฒ
            'ุญุฌุฒ': `๐ **ูุญุฌุฒ ููุนุฏ:**
1. ๐ **ูุงุชููุงู:** 966123456789
2. ๐ **ุฃูููุงูู:** ุงููุฃ ูููุฐุฌ ุงูุญุฌุฒ ูู ุงููููุน
3. ๐ฅ **ุญุถูุฑูุงู:** ุชูุถู ุจุฒูุงุฑุชูุง ูุจุงุดุฑุฉ
4. ๐ฑ **ูุงุชุณุงุจ:** 966123456789

ุฃู ุนูุงุฏุฉ ุชุฑูุฏ ุงูุญุฌุฒ ูููุงุ`,

            // ุงุชุตุงู
            'ุฑูู': `๐ **ูุนูููุงุช ุงูุงุชุตุงู:**
โข ุงููุงุชู ุงูุฑุฆูุณู: 966123456789
โข ุงููุงุชุณุงุจ: 966123456789  
โข ุงูุทูุงุฑุฆ: 966123456789 (24/7)
โข ุงูุจุฑูุฏ: info@clinic.com

ูุชุงุญูู ูุฎุฏูุชู!`,

            // ุนููุงู
            'ุนููุงู': `๐ **ุนููุงู ุงููุฌูุน:**
ูุฌูุน ุนูุงุฏุงุช [ุงุณู ุงููุฌูุน]
ุงูุฑูุงุถ - ุญู ุงูุนููุง - ุดุงุฑุน ุงูููู ููุฏ
(ูุฑุจ ูุฑูุฒ commercial)

๐บ๏ธ **ุงููุตูู:** ููุงูู ูุฌุงููุฉ - ุณูููุฉ ุงููุตูู`,

            // ุฃุณุนุงุฑ
            'ุณุนุฑ': `๐ต **ุจุฎุตูุต ุงูุฃุณุนุงุฑ:**
โข ุงูุฃุณุนุงุฑ ุชุฎุชูู ุญุณุจ ุงูุฎุฏูุฉ ูุงูุนูุงุฏุฉ
โข ูุฏููุง ุจุงูุงุช ูุนุฑูุถ ุฎุงุตุฉ ุฏูุฑูุงู
โข ุฎุตููุงุช ูููุดู ุงูุฏูุฑู ูุงูุนุงุฆูุงุช
โข ุชูุณูุท ูุชุงุญ ูุจุนุถ ุงูุฎุฏูุงุช

๐ ููุงุณุชูุณุงุฑ ุงูุฏููู: 966123456789`,

            // ุทูุงุฑุฆ
            'ุทูุงุฑุฆ': `๐จ **ููุญุงูุงุช ุงูุทุงุฑุฆุฉ:**
โข ูุงุชู ุงูุทูุงุฑุฆ: 966123456789 (24/7)
โข ุฏุงุฎู ุฃููุงุช ุงูุนูู: ุชูุถู ุจุงูุญุถูุฑ ููุฑุงู
โข ููุญุงูุงุช ุงูุญุฑุฌุฉ: ููุตู ุจุงูุชูุฌู ูุฃูุฑุจ ูุณุชุดูู ุทูุงุฑุฆ

๐จโโ๏ธ ุฃุทุจุงุก ูุชุงุญูู ููุทูุงุฑุฆ ุฏุงุฆูุงู`,

            // ูุตุงุฆุญ ุทุจูุฉ ุนุงูุฉ
            'ูุตูุญุฉ': `๐ก **ูุตุงุฆุญ ุทุจูุฉ ุนุงูุฉ:**
โข ๐ง ุงุดุฑุจ 8 ุฃููุงุจ ูุงุก ููููุงู
โข ๐โโ๏ธ ูุงุฑุณ ุงูุฑูุงุถุฉ 30 ุฏูููุฉ ููููุงู
โข ๐ฅ ุชูุงูู ุบุฐุงุก ูุชูุงุฒู
โข ๐ด ุงุญุตู ุนูู 7-8 ุณุงุนุงุช ููู
โข ๐ญ ุชุฌูุจ ุงูุชุฏุฎูู ูุงููุดุฑูุจุงุช ุงูุบุงุฒูุฉ

ูู ุชุฑูุฏ ูุตูุญุฉ ูุญุฏุฏุฉุ`,

            'ุตุญุฉ': `๐ฟ **ููุญูุงุธ ุนูู ุงูุตุญุฉ:**
โข ุงููุญูุตุงุช ุงูุฏูุฑูุฉ ูู 6 ุฃุดูุฑ
โข ุงูุชุทุนููุงุช ุญุณุจ ุงูุฌุฏูู
โข ุงูุฑูุงุถุฉ ุงูููุชุธูุฉ
โข ุงูุบุฐุงุก ุงูุตุญู ุงููุชูุงุฒู
โข ุงูููู ุงููุงูู ูุงูุฑุงุญุฉ

ุงูุนูู ุงูุณููู ูู ุงูุฌุณู ุงูุณููู!`,

            // ุฑุฏ ุงูุชุฑุงุถู ูุญุณู
            'default': `๐ค **ูู ุฃููู ุณุคุงูู ุชูุงูุงูุ ููู ูููููู ูุณุงุนุฏุชู ูู:**

๐ฅ **ูุนูููุงุช ุงูุนูุงุฏุงุช** - ุงุณุฃู ุนู ุนูุงุฏุฉ ูุญุฏุฏุฉ
๐ **ุญุฌุฒ ุงูููุงุนูุฏ** - ููููุฉ ุงูุญุฌุฒ ูุงูุชูุงุตู
๐ **ุงูุฎุฏูุงุช ุงูุทุจูุฉ** - ุงูุฎุฏูุงุช ุงููุชููุฑุฉ
๐ **ุงูุงุชุตุงู ุจูุง** - ุฃุฑูุงู ูุนูุงููู
๐ฟ **ูุตุงุฆุญ ุทุจูุฉ** - ุงุณุชูุณุงุฑุงุช ุตุญูุฉ ุนุงูุฉ

ูุง ุงูุฐู ุชุฑูุฏ ูุนุฑูุชู ุจุงูุถุจุทุ`
        };

        // ุจุญุซ ุฃูุซุฑ ุฐูุงุกู
        for (const [keyword, response] of Object.entries(responses)) {
            if (lowerMessage.includes(keyword)) {
                return response;
            }
        }

        // ุฅุฐุง ูุงู ุณุคุงู ุนู ุนูุงุฏุฉ ูุญุฏุฏุฉ
        if (lowerMessage.includes('ุงุณูุงู') || lowerMessage.includes('ุณู') || lowerMessage.includes('ุถุฑุณ')) {
            return responses['ุนูุงุฏุงุช'] + '\n\n๐ฆท **ุชูุงุตูู ุนูุงุฏุฉ ุงูุฃุณูุงู:** ุชูุธููุ ุญุดูุงุชุ ุชุจููุถุ ุชููููุ ุนูุงุฌ ุฌุฐูุฑุ ุฒุฑุงุนุฉ.';
        }
        
        if (lowerMessage.includes('ุงุทูุงู') || lowerMessage.includes('ุทูู') || lowerMessage.includes('ุฑุถูุน')) {
            return responses['ุนูุงุฏุงุช'] + '\n\n๐ถ **ุชูุงุตูู ุนูุงุฏุฉ ุงูุฃุทูุงู:** ุชุทุนููุงุชุ ูุญูุตุงุช ูููุ ุฃูุฑุงุถ ุดุงุฆุนุฉุ ุงุณุชุดุงุฑุงุช ุฑุถุงุนุฉ.';
        }
        
        if (lowerMessage.includes('ุฌูุฏ') || lowerMessage.includes('ุจุดุฑุฉ') || lowerMessage.includes('ุดุนุฑ')) {
            return responses['ุนูุงุฏุงุช'] + '\n\n๐ฉบ **ุชูุงุตูู ุนูุงุฏุฉ ุงูุฌูุฏูุฉ:** ุญุจ ุดุจุงุจุ ุฃูุฑุงุถ ุฌูุฏูุฉุ ุนูุงูุฉ ุจุงูุจุดุฑุฉุ ุฅุฒุงูุฉ ุดุงูุงุช.';
        }

        if (lowerMessage.includes('ุนูู') || lowerMessage.includes('ููุช') || lowerMessage.includes('ุณุงุนุฉ')) {
            return '๐ **ููุงุนูุฏ ุงูุนูู:**\nโข ุงูุฃุญุฏ-ุงูุฎููุณ: 8:00 ุตุจุงุญุงู - 10:00 ูุณุงุกู\nโข ุงูุฌูุนุฉ: 4:00 ูุณุงุกู - 10:00 ูุณุงุกู\nโข ุงูุณุจุช: 9:00 ุตุจุงุญุงู - 6:00 ูุณุงุกู';
        }

        return responses['default'];
    }

    // ุฏุงูุฉ ุฅุถุงูุฉ ุงูุฑุณุงุฆู
    const appendMessage = (text, sender) => {
        const messageDiv = document.createElement('div');
        messageDiv.classList.add('message', sender);
        
        const messageP = document.createElement('p');
        messageP.innerHTML = text;
        
        messageDiv.appendChild(messageP);
        chatBody.appendChild(messageDiv);

        // ุงูุชูุฑูุฑ ููุฃุณูู
        chatBody.scrollTop = chatBody.scrollHeight;
        return messageDiv;
    };

    // ุฏุงูุฉ ุฅุฑุณุงู ุงูุฑุณุงูุฉ
    const handleSendMessage = async () => {
        const userInput = chatInput.value.trim();
        if (userInput === '') return;

        // ุฅุถุงูุฉ ุฑุณุงูุฉ ุงููุณุชุฎุฏู
        appendMessage(`<strong>ุฃูุช:</strong> ${userInput}`, 'user');
        chatInput.value = '';
        
        if (sendBtn) sendBtn.disabled = true;

        // ูุคุดุฑ ุงููุชุงุจุฉ
        const typingIndicator = appendMessage('<div class="typing-indicator">ุฌุงุฑู ุงููุชุงุจุฉ...</div>', 'bot');

        try {
            // ุงูุฎุทูุฉ 3: ุชุฃูุฏ ูู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุตุญูุญุฉ:
            // ุงูุญุตูู ุนูู ุงูุฑุฏ ูู ุงูู API (ุฃู ุงูุฑุฏ ุงููุญูู ุฅุฐุง ูุดู ุงูู API)
            const botResponse = await getAIResponse(userInput);
            
            // ุฅุฒุงูุฉ ูุคุดุฑ ุงููุชุงุจุฉ ูุฅุถุงูุฉ ุงูุฑุฏ ุงูููุงุฆู
            if (typingIndicator && typingIndicator.parentNode) typingIndicator.remove();
            appendMessage(`<strong>ุงููุณุงุนุฏ:</strong> ${botResponse}`, 'bot');
            
        } catch (error) {
            // ูุฐุง ุงูุฌุฒุก ูู ูุชู ุงููุตูู ุฅููู ุนุงุฏุฉู ูุฃู getAIResponse ุชุนุงูุฌ ุงูุฃุฎุทุงุก ุฏุงุฎููุงู
            // ูููู ูุฅุฌุฑุงุก ุงุญุชุฑุงุฒูุ ูููููุง ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ุนุงูุฉ ููุง
            if (typingIndicator && typingIndicator.parentNode) typingIndicator.remove();
            appendMessage(`<strong>ุงููุณุงุนุฏ:</strong> ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน. ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู.`, 'bot');
        } finally {
            if (sendBtn) sendBtn.disabled = false; // ุฅุนุงุฏุฉ ุชูุนูู ุงูุฒุฑ ุฏุงุฆูุงู
        }
    };

    // ุฅุถุงูุฉ event listeners
    if (sendBtn && chatInput) {
        sendBtn.addEventListener('click', handleSendMessage);

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleSendMessage();
            }
        });
    }

    // ุฅุธูุงุฑ ุฑุณุงูุฉ ุชุฑุญูุจ ุนูุฏ ูุชุญ ุงูุดุงุช ุจูุช
    if (chatbotToggle) {
        chatbotToggle.addEventListener('click', () => {
            // ุฅุถุงูุฉ ุฑุณุงูุฉ ุชุฑุญูุจ ููุท ุฅุฐุง ูุงูุช ุงูุดุงุช ูุงุถูุฉ
            if (chatBody.children.length <= 1) {
                setTimeout(() => {
                    appendMessage(`<strong>ุงููุณุงุนุฏ:</strong> ุฃููุงู ูุณููุงู! ๐ ุฃูุง ุงููุณุงุนุฏ ุงูุงูุชุฑุงุถู ููุนูุงุฏุฉ. ููู ูููููู ูุณุงุนุฏุชู ุงููููุ`, 'bot');
                }, 500);
            }
        });
    }
});